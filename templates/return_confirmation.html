{% extends "base.html" %}

{% block title %}Return Confirmation{% endblock %}

{% block content %}
<div class="return-confirmation-page">
    <h1>Vehicle Return Confirmation</h1>

    <div class="confirmation-container">
        <!-- Return Type Banner -->
        <div class="return-banner {{ result['return_type'] }}">
            {% if result['return_type'] == 'early' %}
            <div class="banner-icon">✓</div>
            <div class="banner-content">
                <h2>Early Return</h2>
                <p>Thank you for returning the vehicle early!</p>
            </div>
            {% elif result['return_type'] == 'overdue' %}
            <div class="banner-icon">⚠</div>
            <div class="banner-content">
                <h2>Overdue Return</h2>
                <p>Vehicle was returned after the scheduled date.</p>
            </div>
            {% else %}
            <div class="banner-icon">✓</div>
            <div class="banner-content">
                <h2>On-Time Return</h2>
                <p>Vehicle returned as scheduled.</p>
            </div>
            {% endif %}
        </div>

        <!-- Vehicle Information -->
        <div class="info-section">
            <h3>Vehicle Information</h3>
            <table class="info-table">
                <tr>
                    <td>Vehicle:</td>
                    <td><strong>{{ vehicle.get_year() }} {{ vehicle.get_make() }} {{ vehicle.get_model() }}</strong></td>
                </tr>
                <tr>
                    <td>Vehicle ID:</td>
                    <td>{{ vehicle.get_vehicle_id() }}</td>
                </tr>
            </table>
        </div>

        <!-- Rental Dates -->
        <div class="info-section">
            <h3>Rental Period</h3>
            <table class="info-table">
                <tr>
                    <td>Rental Start Date:</td>
                    <td>{{ result['record'].get_start_date() }}</td>
                </tr>
                <tr>
                    <td>Scheduled End Date:</td>
                    <td>{{ result['scheduled_end_date'] }}</td>
                </tr>
                <tr class="highlight">
                    <td>Actual Return Date:</td>
                    <td><strong>{{ result['actual_return_date'] }}</strong></td>
                </tr>
            </table>
        </div>

        <!-- Cost Breakdown -->
        <div class="info-section cost-section">
            <h3>Cost Summary</h3>
            <table class="cost-table">
                <tr>
                    <td>Scheduled Days:</td>
                    <td>{{ result['scheduled_days'] }} days</td>
                </tr>
                <tr>
                    <td>Actual Days:</td>
                    <td>{{ result['actual_days'] }} days</td>
                </tr>
                <tr class="divider">
                    <td colspan="2"></td>
                </tr>
                <tr>
                    <td>Original Cost:</td>
                    <td>${{ "%.2f"|format(result['original_cost']) }}</td>
                </tr>

                {% if result['return_type'] == 'early' and result['refund'] > 0 %}
                <tr class="refund-row">
                    <td>Refund:</td>
                    <td>- ${{ "%.2f"|format(result['refund']) }}</td>
                </tr>
                {% elif result['return_type'] == 'overdue' and result['penalty'] > 0 %}
                <tr class="penalty-row">
                    <td>Overdue Penalty (150% rate):</td>
                    <td>+ ${{ "%.2f"|format(result['penalty']) }}</td>
                </tr>
                {% endif %}

                <tr class="divider">
                    <td colspan="2"></td>
                </tr>
                <tr class="total-row">
                    <td><strong>Final Cost:</strong></td>
                    <td><strong>${{ "%.2f"|format(result['final_cost']) }}</strong></td>
                </tr>
            </table>
        </div>

        <!-- Message -->
        <div class="message-box {{ result['return_type'] }}">
            <p>{{ result['message'] }}</p>
        </div>

        <!-- Actions -->
        <div class="actions">
            <a href="{{ url_for('dashboard') }}" class="btn btn-primary">Back to Dashboard</a>
            <a href="{{ url_for('rental_history') }}" class="btn btn-secondary">View History</a>
        </div>
    </div>
</div>

<style>
.return-confirmation-page {
    max-width: 700px;
    margin: 0 auto;
    padding: 2rem 1rem;
}

.return-confirmation-page h1 {
    text-align: center;
    margin-bottom: 2rem;
    color: #2c3e50;
}

.confirmation-container {
    background: white;
    border-radius: 8px;
    border: 1px solid #e0e0e0;
    overflow: hidden;
}

/* Return Banner */
.return-banner {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    padding: 2rem;
}

.return-banner.normal {
    background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
    color: #155724;
}

.return-banner.early {
    background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
    color: #0c5460;
}

.return-banner.overdue {
    background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%);
    color: #856404;
}

.banner-icon {
    font-size: 3rem;
    line-height: 1;
}

.banner-content h2 {
    margin: 0 0 0.5rem 0;
    font-size: 1.5rem;
}

.banner-content p {
    margin: 0;
    font-size: 1rem;
}

/* Info Sections */
.info-section {
    padding: 1.5rem 2rem;
    border-bottom: 1px solid #e0e0e0;
}

.info-section:last-of-type {
    border-bottom: none;
}

.info-section h3 {
    margin: 0 0 1rem 0;
    color: #2c3e50;
    font-size: 1.1rem;
}

.info-table {
    width: 100%;
    border-collapse: collapse;
}

.info-table tr {
    border-bottom: 1px solid #f0f0f0;
}

.info-table tr:last-child {
    border-bottom: none;
}

.info-table td {
    padding: 0.75rem 0;
    font-size: 0.95rem;
}

.info-table td:first-child {
    color: #666;
    width: 45%;
}

.info-table td:last-child {
    color: #2c3e50;
}

.info-table tr.highlight td {
    background-color: #f8f9fa;
    font-weight: 600;
}

/* Cost Table */
.cost-section {
    background-color: #f8f9fa;
}

.cost-table {
    width: 100%;
    border-collapse: collapse;
}

.cost-table tr {
    border-bottom: 1px solid #e0e0e0;
}

.cost-table tr:last-child {
    border-bottom: none;
}

.cost-table td {
    padding: 0.75rem 0;
    font-size: 0.95rem;
}

.cost-table td:first-child {
    color: #666;
}

.cost-table td:last-child {
    text-align: right;
    color: #2c3e50;
}

.cost-table tr.divider {
    height: 0.5rem;
    border-bottom: 2px solid #ddd;
}

.cost-table tr.refund-row td {
    color: #28a745;
    font-weight: 600;
}

.cost-table tr.penalty-row td {
    color: #dc3545;
    font-weight: 600;
}

.cost-table tr.total-row {
    background-color: #e9ecef;
}

.cost-table tr.total-row td {
    padding: 1rem 0;
    font-size: 1.1rem;
    font-weight: 700;
}

/* Message Box */
.message-box {
    margin: 1.5rem 2rem;
    padding: 1rem;
    border-radius: 6px;
    border: 1px solid;
}

.message-box.normal {
    background-color: #d4edda;
    border-color: #c3e6cb;
    color: #155724;
}

.message-box.early {
    background-color: #d1ecf1;
    border-color: #bee5eb;
    color: #0c5460;
}

.message-box.overdue {
    background-color: #fff3cd;
    border-color: #ffeaa7;
    color: #856404;
}

.message-box p {
    margin: 0;
    font-weight: 500;
}

/* Actions */
.actions {
    display: flex;
    gap: 1rem;
    padding: 1.5rem 2rem;
    background-color: #f8f9fa;
}

.btn {
    flex: 1;
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 6px;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    text-decoration: none;
    text-align: center;
    transition: all 0.2s ease;
}

.btn-primary {
    background-color: #2c3e50;
    color: white;
}

.btn-primary:hover {
    background-color: #1a252f;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background-color: #5a6268;
}

/* Responsive */
@media (max-width: 768px) {
    .return-confirmation-page {
        padding: 1rem;
    }

    .return-banner {
        flex-direction: column;
        text-align: center;
        padding: 1.5rem;
    }

    .info-section,
    .message-box,
    .actions {
        padding: 1rem;
    }

    .actions {
        flex-direction: column;
    }
}
</style>
{% endblock %}
